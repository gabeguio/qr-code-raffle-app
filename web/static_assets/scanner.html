<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="text/javascript" src="/assets/scanner.js"></script>
    <link rel="icon" href="" type="image/png" />
    <link rel="stylesheet" type="text/css" href="styles/modern-normalize.css" />
    <link rel="stylesheet" type="text/css" href="styles/style.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/header.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/scanner.css" />
    <link rel="stylesheet" type="text/css" href="styles/components/footer.css" />
    <link rel="stylesheet" type="text/css" href="styles/utils.css" />
    <title>Scanner Page</title>
  </head>
  <body>
    <main>
      <header class="header" id="header"></header>
      <section class="controller container">
        <div id="error-message"></div>
        <button class="btn scanner-btn" id="startScanning" color="black">Scan a Vistor</button>
      </section>
      <section>
        <p>Spinner Below</p>
        <span class="loader"></span>
      </section>
      <section class="scanner" id="scanner">
        <div id="reader"></div>
        <div id="writer"></div>
      </section>
      <footer class="footer container section">
        <h3 class="footer__title">Qr Code Raffle App 1.0</h3>
        <h3 class="footer__title">
          By
          <a href="https://www.linkedin.com/in/gabe-guio/">Gabe Guio</a>
        </h3>
      </footer>
    </main>
    <!-- <script>
      function onScanFailure(error) {
        // handle scan failure, usually better to ignore and keep scannin);g.
        // for example:
        console.warn(`Code scan error = ${error}`);
      }

      function parseVCard(decodedText) {
        const lines = decodedText.split("\n");
        const vCard = {};

        lines.forEach((line) => {
          const [key, value] = line.split(":");
          if (key && value) {
            // Normalize key to lowercase and remove non-alphanumeric characters
            const normalizedKey = key.trim().toLowerCase().replace(/\W/g, "");
            vCard[normalizedKey] = value.trim();
          }
        });

        return vCard;
      }

      let html5QrcodeScanner = new Html5QrcodeScanner("reader", { fps: 10, qrbox: { width: 200, height: 200 } }, /* verbose= */ false);
      html5QrcodeScanner.render(onScanSuccess, onScanFailure);

      function onScanSuccess(decodedText, decodedResult) {
        // Handle on success condition with the decoded text or result.
        // console.log(`Scan result: ${decodedText}`, decodedResult);

        // log results to div id called writer

         const vCardObject = parseVCard(decodedText);

         const {fn, email, org} = vCardObject

        document.getElementById("writer").innerHTML = `<p>${fn} from ${org} has been checked in!</p>`

        console.log(vCardObject);
        // ...
        html5QrcodeScanner.clear();
        // ^ this will stop the scanner (video feed) and clear the scan area.
      }

      html5QrcodeScanner.render(onScanSuccess);
    </script> -->
  </body>
</html>

<!-- <form class="create-form">
  <h2>Create Scanner</h2>
  <div class="form-group">
    <label for="scanner-email">Scanner Email:</label>
    <input type="text" id="scanner-email" name="scanner-email" required />
  </div>
  <div class="form-group">
    <label for="sponsor-name">Sponsor Name:</label>
    <select id="sponsor-name" name="sponsor-name">
      <option value="CGI">CGI</option>
      <option value="Sigma">Sigma</option>
      <option value="Lovelytics">Lovelytics</option>
    </select>
  </div>
  <button type="submit" onclick="logFormValues()">Create</button>
</form> -->
